<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>FF Survey</title>

	<!-- Latest compiled and minified CSS & JS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<script src="https://code.jquery.com/jquery.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
		<!-- Chosen -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>

</head>
<body>

	<div class="container">
		
		<div class="jumbotron">
			<h1 class="text-center"><span class="glyphicon glyphicon-fire"></span>Friend Finder</h1>


		</div>

		<div class="row">
			<div class="col-lg-12">

				<!-- Reservation Page -->
				<div class="panel panel-default">
					<div class="panel-heading">
						<h4 class="panel-title">Survey Questions</h4>
					</div>
					<div class="panel-body">

						<form role="form">
				
							<div class="form-group">
								<label for="">Name</label>
								<input type="text" class="form-control" id="name">
							</div>

							<div class="form-group">
								<label for="">Picture Link</label>
								<input type="text" class="form-control" id="photo">
							</div>

							<h3><strong>Question 1</strong></h3>
							<h4>Love waking up early!</h4>
						 	<select data-placeholder="" class="chosen-select" id="q1">
						 		<option value=""></option>
					            <option value="1">1 (Strongly Disagree)</option>
					            <option value="2">2</option>
					            <option value="3">3</option>
					            <option value="4">4</option>
					            <option value="5">5 (Strongly Agree)</option>
					      	</select>

							<h3><strong>Question 1</strong></h3>
							<h4>You are Voting for Trump!</h4>
						 	<select data-placeholder="" class="chosen-select" id="q2">
						 		<option value=""></option>
					            <option value="1">1 (Strongly Disagree)</option>
					            <option value="2">2</option>
					            <option value="3">3</option>
					            <option value="4">4</option>
					            <option value="5">5 (Strongly Agree)</option>
					      	</select>

					      	<h3><strong>Question 1</strong></h3>
							<h4>Cows are awesome</h4>
						 	<select data-placeholder="" class="chosen-select" id="q3">
						 		<option value=""></option>
					            <option value="1">1 (Strongly Disagree)</option>
					            <option value="2">2</option>
					            <option value="3">3</option>
					            <option value="4">4</option>
					            <option value="5">5 (Strongly Agree)</option>
					      	</select>

					      	<h3><strong>Question 1</strong></h3>
							<h4>Ewoks are Awesome!</h4>
						 	<select data-placeholder="" class="chosen-select" id="q4">
						 		<option value=""></option>
					            <option value="1">1 (Strongly Disagree)</option>
					            <option value="2">2</option>
					            <option value="3">3</option>
					            <option value="4">4</option>
					            <option value="5">5 (Strongly Agree)</option>
					      	</select>

					      	<h3><strong>Question 1</strong></h3>
							<h4>you are more of an introvert</h4>
						 	<select data-placeholder="" class="chosen-select" id="q5">
						 		<option value=""></option>
					            <option value="1">1 (Strongly Disagree)</option>
					            <option value="2">2</option>
					            <option value="3">3</option>
					            <option value="4">4</option>
					            <option value="5">5 (Strongly Agree)</option>
					      	</select>

					      	<h3><strong>Question 1</strong></h3>
							<h4>You love coding</h4>
						 	<select data-placeholder="" class="chosen-select" id="q6">
						 		<option value=""></option>
					            <option value="1">1 (Strongly Disagree)</option>
					            <option value="2">2</option>
					            <option value="3">3</option>
					            <option value="4">4</option>
					            <option value="5">5 (Strongly Agree)</option>
					      	</select>

					      	<h3><strong>Question 1</strong></h3>
							<h4>You are more of a front end developer</h4>
						 	<select data-placeholder="" class="chosen-select" id="q7">
						 		<option value=""></option>
					            <option value="1">1 (Strongly Disagree)</option>
					            <option value="2">2</option>
					            <option value="3">3</option>
					            <option value="4">4</option>
					            <option value="5">5 (Strongly Agree)</option>
					      	</select>

					      	<h3><strong>Question 1</strong></h3>
							<h4>you believe IQ is just a number!</h4>
						 	<select data-placeholder="" class="chosen-select" id="q8">
						 		<option value=""></option>
					            <option value="1">1 (Strongly Disagree)</option>
					            <option value="2">2</option>
					            <option value="3">3</option>
					            <option value="4">4</option>
					            <option value="5">5 (Strongly Agree)</option>
					      	</select>

					      	<h3><strong>Question 1</strong></h3>
							<h4>Jesus is your BAE</h4>
						 	<select data-placeholder="" class="chosen-select" id="q9">
						 		<option value=""></option>
					            <option value="1">1 (Strongly Disagree)</option>
					            <option value="2">2</option>
					            <option value="3">3</option>
					            <option value="4">4</option>
					            <option value="5">5 (Strongly Agree)</option>
					      	</select>

					      	<h3><strong>Question 1</strong></h3>
							<h4>You knew Bae is poop in Danish.</h4>
						 	<select data-placeholder="" class="chosen-select" id="q10">
						 		<option value=""></option>
					            <option value="1">1 (Strongly Disagree)</option>
					            <option value="2">2</option>
					            <option value="3">3</option>
					            <option value="4">4</option>
					            <option value="5">5 (Strongly Agree)</option>
					      	</select>
					      	<br>
					      	<br>

							<button type="submit" class="btn btn-primary submit">Submit</button>
						</form>

					</div>
				</div>
	
			</div>
		</div>

	<!-- Modal -->
	<div id="resultsModal" class="modal fade" role="dialog">
	  <div class="modal-dialog">

	    <!-- Modal content-->
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal">&times;</button>
	        <h2 class="modal-title"><strong>Your New Best Friend!</strong></h2>
	      </div>
	      <div class="modal-body">
	        <h2 id="matchName"></h2>
	        <img id="matchImg" src="https://media.licdn.com/mpr/mpr/shrinknp_400_400/p/6/005/064/1bd/3435aa3.jpg" alt="">
	      </div>


	</div>
	
</body>
</html>

<!-- BELOW CODE IS CRITICAL. IT HANDLES HOW FORM DATA IS SENT TO OUR SERVER -->
<script type="text/javascript">

	// In this code below we create the Front-end Javascript which "POSTS" our form data to our express server.
	// In essence, when the user hits submit, jQuery grabs all of the fields then sends a post request to our api
	// Our api recognizes the route (/api/tables)... and then runs the associated code (found in api-routes.js).
	// In this case the associated code "saves" the data to the table-data.js file or waitinglist-data.js file 

	$(".submit").on("click", function(){

		
    	// Form validation
    	function validateForm() {
		  var isValid = true;
		  $('.form-control').each(function() {
		    if ( $(this).val() === '' )
		        isValid = false;
		  });

		  $('.chosen-select').each(function() {

		  	if( $(this).val() === "")
		  		isValid = false
		  })
		  return isValid;
		}

		// If all required fields are filled
		if (validateForm() == true)
		{
			// Create an object for the user's data
			var newFriend = {
				name: $('#name').val().trim(),
				photo: $('#photo').val().trim(),
				answers: [$('#q1').val().trim(),
				$('#q2').val().trim(),
				$('#q3').val().trim(),
				$('#q4').val().trim(),
				$('#q5').val().trim(),
				$('#q6').val().trim(),
				$('#q7').val().trim(),
				$('#q8').val().trim(),
				$('#q9').val().trim(),
				$('#q10').val().trim()
				]
			};

			console.log(newFriend);


	    	// Grab the URL of the website
	    	var currentURL = window.location.origin;

	    	// AJAX post the data to the friends API. 
	    	$.post(currentURL + "/api/friends", newFriend,
	    	function(data){

	    		// Grab the result from the AJAX post so that the best match's name and photo are displayed.
	    			console.log(data);
	    		$("#matchName").text(data.name);
	    		$('#matchImg').attr("src", data.pic);

		    	// Show the modal with the best match 
		    	$("#resultsModal").modal('toggle');

	    	});
		}
		else {
			alert("Please fill out all fields before submitting!");
		}
		// Here we grab the form elements
		

		// This line is the magic. It's very similar to the standard ajax function we used. 
		// Essentially we give it a URL, we give it the object we want to send, then we have a "callback".
		// The callback is the response of the server. In our case, we set up code in api-routes that "returns" true or false
		// depending on if a tables is available or not. 

		// Here we get the location of the root page. 
		// We use this instead of explicitly saying the URL is localhost:3001 because the url will change when we deploy.


return false;

});


</script>